# YTautoPlaylist

Automatic playlist collector from YouTube subscriptions.

Сбор новых видео на основе подписок ютуба и создания из этих видео плейлиста. Расширение умеет фильтровать список по многим параметрам таким как длительность, теги, назватия, тип видео (трансляция, шортс). Пока настройка фильтров возможна только через код, а ход работы отображается в консоли service worker.

При указании фильтров по тегам используйте сами названия тегов без знака `#`. YouTube хранит теги отдельно от хештегов в заголовке, поэтому `#example` в названии может отсутствовать в списке тегов. Теперь фильтр также проверяет хештеги в заголовке видео. Теги сравниваются без учёта пробелов, поэтому можно писать их с пробелами или без.
Фильтры делятся на глобальные и индивидуальные для каналов. Сначала применяется глобальный набор правил, затем к результату добавляются ограничения конкретного канала. Списки слов и диапазоны длительности объединяются, а флажки «Игнорировать Shorts» и «Игнорировать трансляции» могут быть переопределены в карточке канала. Если такие флажки включены глобально, они скрываются в настройках каналов.

# ToDo

- [ ] Уведомление, что фильтры сохранили и более удобная кнопка для сохранения, чтобы не надо было листать вниз. К примеру прямо в карточке, если вносишь изменения. И обновляет данные по конкретной карточке, а не всем.
- [ ] Получить инфо о видео для создания фильтра. Указываешь ссылку, получаем важную информацию и предварительно отображаем форму фильтров на основании. Далее можно поправить и сохранить. Это отдельная форма. При сохранении значения подставляются в карточку соответствующего канала, или новую карточку канала. Т.е. сначала настраиваем, потом смотрим.
- [ ] Фильтр "наличие в плейлисте". Скорее по наличию фразы в тайтле плейлиста. Надо смотреть структуры данных.
- [ ] Фильтр на основе описания.
- [ ] В случае какого-то сбоя работа должна "паузится" и сохраняться для продолжения. В логах должна быть информация что произошло и что будет далее. Если дошли до создания списка, то сохранять то что не добавили, чтобы закончить это в следующий заход. Если зависли на сборе информации, сохранить текущую инфу и продолжить. Это касается случаев, когда автоматически продолжить через несколько минут невозможно, т.е. пауза требует часов и суток, что ждать никто не будет.
- [ ] Локализация, поддержка английского.
- [ ] Интерфейс отображающий ход работы сбора плейлиста по api из подписок. Там должен быть прогресс как общий, так и по этапам, а также лог событий в удобном формате. Пройденные без ошибок этапы скрывать спойлерами. Текущий этап отображать в логе. Новые записи добавлять сверху, чтобы не прокручивать страницу. В итоге смотришь на добавление: идёт прогресс, внизу логи.
  - [ ] Возможность не смотреть на логи (работа в фоне)
  - [ ] Возможность вызывать интерфейс добавления
- [ ] Не создавать список воспроизведения, а управлять списками. Собрать список дешево, а вот плейлист - дорого. Плюс плейлисты тратят ресурсы, тупят, лагают. 
  - [ ] Расширением управлять и переключать на следующее видео. 
  - [ ] Удалять просмотренные из списка, но сохранять возможность вернуться назад на 5 видео, т.е. удалять всё что далее последних 5 видео. 
  - [ ] На уровне расширения позволять что-то докинуть в очередь, легко и быстро удалить из очереди. 
  - [ ] Сделать возможность ведения нескольких списков: основной, отложить, и вручную созданные. 
  - [ ] Чтобы можно было самому создавать сколько угодно списков. И чтобы можно было быстро перетащить видео из основного в побочный, бех глюков поменять порядок видео в списке. 
  - [ ] Чтобы в любой момент можно было зайти на страницу и добавить вручную любое видео в список. Или автоматически добавить все, несколько.
  - [ ] Управление плейлистами вести через папап и отдельную страницу.
    - [ ] Текущий плейлист + кнопка пехода на страницу управления в попапе. Также там быстрые кнопка для переноса и удаления видео, обновления списка, переключения на другой лист.
    - [ ] На странице управления уже более мощный интерфейс, возможность создавать листы, менеджерить их, переименовать, слиять.
- [ ] Комбинации фильтров через "и" и "или", чтобы можно было сделать: исключить трансляции с тегом X длиной больше 15 минут, исключить все шортсы кроме с Х в заголовке.

## Бонусные функции для работы с ютуб
- [ ] Возможность добавить все видео со страницы в список расширения или список "очередь ютуб" или список "смотреть позже". Т.е. прокикать на странице кнопки, или собрать ссылки и добавить в очередь в прямом порядке. Встраивать на подходящую страницу кнопки для быстрых действий.
- [ ] Удалить просмотренные из текущего списка
  - [ ] Кнопка "удалить выше" - прокликать удаление из плейлиста от конкретного ввидео до начала, т.е. вверх
  - [ ] Если смотришь плейлист, то из списка воспроизведения прокликать удаление
- [ ] Возможность добавить фильтр находясь на канале, или прямо просматривая видео с предзаполнением полей: подхватить канал, название из видео, длительность, теги, тип.

# Technical details

## Video object

The extension operates with the `Video` structure defined in [`src/types.d.ts`](src/types.d.ts). Key fields:

- `id` – video identifier
- `publishedAt` – publication date (`Date`)
- `title`, `channelId`, `channelTitle` – metadata about the video and channel
- `tags`, `duration`, `liveStreamingDetails` – additional information
- `playlist` – source playlist identifier

## Channel object

Channel information is cached in `chrome.storage.local` and contains:

- `id` – channel identifier
- `title` – display name
- `uploads` – uploads playlist identifier
